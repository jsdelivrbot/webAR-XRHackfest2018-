<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>XRHACKFEST2018</title>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.0/aframe/build/aframe-ar.min.js"> </script>
</head>
<body>
    <style>
        body{
            margin:0;
            padding:0;
        }
        .btnContent{
            position: fixed;
            z-index:1;
            bottom:0;
        }
        #testPos{
            width:100px;
            height:100px;
            position: absolute;
            z-index:10;
            background:black;
            cursor: pointer;
        }
        .topMessage{
            position: fixed;
            top:0;
            width:100%;
            padding:20px;
            background:rgba(0,0,0,0.5);
            font-size:20px;
            color:#fff;
        }
    </style>
    <script type="text/javascript">
        var scene;
        var box;
        var changeBtn = document.getElementById('change');
        var topmsg = document.querySelector('.topMessage');
        var position;
        AFRAME.registerComponent('clbf',{
            init:function(e){
                this.show = false;
                position = this.el.getAttribute('position');
                console.log(this.el.object3D,'init');
                console.log(position,'pos');
                // this.el.sceneEl.addEventListener('markerFound',function(){
                //     console.log('hi');
                // });
            },
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    // this.el.emit('markerFound');
                    changeModel('fish');
                }
            },

        });
        AFRAME.registerComponent('clbf',{
            init:function(e){
                this.show = false;
                position = this.el.getAttribute('position');
                console.log(this.el.object3D,'init');
                console.log(position,'pos');
            },
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('clbf');
                    // this.el.emit('markerFound');
                }
            },

        });
        function changeModel(current){
            if(current == 'clbf'){
                topmsg.text = '澄清湖球場!!';
            }else if(current == 'fish'){
                topmsg.text = '花蓮漁港!!';
            }else{
                topmsg.text = '';
            }
            // var random = Math.floor((Math.random() * 4) + 1);
            // box.setAttribute('material','color:'+colorArray[random]+';');
        }
    </script>
        <div class="topMessage">

        </div>
        <a-scene id="a-scene" embedded arjs='sourceType:webcam; trackingMethod: best; debugUIEnabled: false;'>
                <a-assets>
                        <a-asset-item id="fish" src="model/building/fish/fish.gltf">
                        <a-asset-item id="clbf" src="model/building/clbf/clbf.gltf">
                </a-assets>
                <!-- <a-plane material="src:#markerImg; width:2; height:2;" position='0 0 -2'></a-plane>  -->
                <!-- <a-box id="mainbox" position='0 0.5 -5' material='color: blue;'></a-box>  -->
                 <a-marker clbf id="Marker1" preset="hiro" rotation="0 0 0">
                         <!-- <a-box id="mainbox" position='0 0.5 0' material='color: blue;'></a-box>   -->
                         <a-gltf-model src="#clbf" position="0 0.5 0" rotation="0 180 0" scale="0.00001 0.00001 0.00001"></a-gltf-model>  
                         <!-- <a-gltf-model src="#fish" position="0 0.5 0" scale="0.01 0.01 0.01"></a-gltf-model> -->
                  </a-marker>
                  <a-marker fish id="Marker2" preset="kaiji" rotation="0 0 0">
                        <a-gltf-model src="#fish" position="0 0.5 0" scale="0.01 0.01 0.01"></a-gltf-model>
                 </a-marker>
                 <!-- <a-marker-camera id="camera" preset='hiro' position="0 0 23"> </a-marker-camera>  -->
                <a-camera-static position="0 0 2"/>
                <!-- <a-entity camera position="-2 13 0" rotation="-90 0 0"></a-entity> -->
        </a-scene>
        <div class="btnContent">
            <button id="change" onClick="changeModel()">Click me to change model</button>
        </div>
    <!-- <div id="sceneContainer"></div>
<script type="text/javascript" src="index_bundle.js"></script> -->
</body>
</html>