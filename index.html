<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>XRHACKFEST2018</title>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.0/aframe/build/aframe-ar.min.js"> </script>
</head>
<body>
    <style>
        body{
            margin:0;
            padding:0;
            background:url('img/ajax-loader.gif');
            background-position:center;
            background-repeat:no-repeat;
            background-size:contain;
        }
        .linkContent{
            width:100%;
            position: fixed;
            z-index:1;
            bottom:0;
            left: 0;
        }
        #testPos{
            width:100px;
            height:100px;
            position: absolute;
            z-index:1;
            background:black;
            cursor: pointer;
        }
        .topMessage{
            position: fixed;
            top:0;
            left: 0;
            width:100%;
            padding:20px;
            background:rgba(0,0,0,0.5);
            font-size:20px;
            color:#fff;
            z-index:10;
        }
    </style>
    <script type="text/javascript">
        var scene;
        var box;
        var changeBtn = document.getElementById('change');
        var topmsg = document.querySelector('.topMessage');
        var position;
        
        AFRAME.registerComponent('main',{
            init:function(e){
                this.show = false;
                position = this.el.getAttribute('position');
                console.log(this.el.object3D,'init');
                console.log(position,'pos');
            },
            tick:function(t,td){
                if(this.el.object3D.visible){
                    changeModel('main');
                }
            },

        });

        // location
        AFRAME.registerComponent('taipei',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    // this.el.emit('markerFound');
                    changeModel('taipei');
                }
            },

        });
        AFRAME.registerComponent('kaohsung',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('kaohsung');
                    // this.el.emit('markerFound');
                }
            },
        });
        AFRAME.registerComponent('huanlian',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('huanlian');
                    // this.el.emit('markerFound');
                }
            },
        });
        AFRAME.registerComponent('ilan',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('ilan');
                    // this.el.emit('markerFound');
                }
            },
        });
        AFRAME.registerComponent('taichung',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('taichung');
                    // this.el.emit('markerFound');
                }
            },
        });
        AFRAME.registerComponent('tainan',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('tainan');
                    // this.el.emit('markerFound');
                }
            },
        });
        AFRAME.registerComponent('taitong',{
            tick:function(t,td){
                if(this.el.object3D.visible){
                    // alert('yo');
                    changeModel('taitong');
                    // this.el.emit('markerFound');
                }
            },
        });
        function changeModel(current){
            if(current == 'kaohsung'){
                document.querySelector('.topMessage').innerHTML = '高雄';
            }else if(current == 'taipei'){
                document.querySelector('.topMessage').innerHTML = '台北';
            }else if(current == 'huanlian'){
                document.querySelector('.topMessage').innerHTML = '花蓮';
            }
            else if(current == 'ilan'){
                document.querySelector('.topMessage').innerHTML = '宜蘭';
            }
            else if(current == 'taichung'){
                document.querySelector('.topMessage').innerHTML = '台中';
            }else if(current == 'tainan'){
                document.querySelector('.topMessage').innerHTML = '台南';
            }else if(current == 'taitong'){
                document.querySelector('.topMessage').innerHTML = '台東';
            }
            else if(current == 'main'){
                document.querySelector('.topMessage').innerHTML = '可以開始掃描各地QRcode';
            }
            else{
                document.querySelector('.topMessage').innerHTML = '歡迎使用webAr地圖!!';
            }
            // var random = Math.floor((Math.random() * 4) + 1);
            // box.setAttribute('material','color:'+colorArray[random]+';');
        }
    </script>
        <div class="topMessage">
            <div class="info">
                 歡迎使用webAr地圖!!
            </div>
        </div>

        <a-scene id="a-scene" embedded arjs='sourceType:webcam; trackingMethod: best;  debugUIEnabled: false;'>
                <a-assets>
                        <a-asset-item id="fish" src="model/building/fish/fish.gltf">
                        <a-asset-item id="clbf" src="model/building/clbf/clbf.gltf">
                        <a-asset-item id="flagObj" src="model/flag/USMC_flag.obj"></a-asset-item>
                        <a-asset-item id="flagMtl" src="model/flag/USMC_flag.mtl"></a-asset-item>
                        <a-asset-item id="101" src="model/building/101/101.gltf"></a-asset-item>
                </a-assets>
                <!-- <a-plane material="src:#markerImg; width:2; height:2;" position='0 0 -2'></a-plane>  -->
                <!-- <a-box id="mainbox" position='0 0.5 -5' material='color: blue;'></a-box>  -->
                <a-entity obj-model="obj:#flagObj; mtl:#flagMtl" scale="0.02 0.02 0.02"   position="0 0 0"></a-entity>
                 <a-marker main id="Marker1" preset="hiro" rotation="0 0 0">
                         <a-box id="mainbox" position='0 0.5 0' material='color:gold;'></a-box>  
                  </a-marker>
                  <!-- <a-marker fish id="Marker2" preset="kanji" rotation="0 0 0">
                        <a-gltf-model src="#fish" position="0 0.5 0" scale="0.01 0.01 0.01"></a-gltf-model>
                 </a-marker> -->
                 <a-marker taipei type="pattern" url="img/ar-markers/taipei/pattern-marker-taipei.patt">
                    <a-gltf-model src="#101" position="-0.5 0 0" rotation="0 180 0" scale="0.01 0.01 0.01">
                            <a-animation  attribute="rotation" to="0 180 360"
                            easing="linear" dur="3000" repeat="indefinite"></a-animation>
                    </a-gltf-model>
                </a-marker>
                 <a-marker huanlian type="pattern" url="img/ar-markers/huanlian/pattern-marker-huanlian.patt">
                    <a-box  position='0 0.5 0' material='color: blue;'>
                        <a-animation  attribute="rotation" to="0 360 0"
                        easing="linear" dur="1000" repeat="indefinite"></a-animation>
                    </a-box>
                </a-marker>
                <a-marker ilan type="pattern" url="img/ar-markers/ilan/pattern-marker-ilan.patt">
                    <a-box  position='0 0.5 0' material='color: green;'>
                        <a-animation  attribute="rotation" to="0 360 0"
                        easing="linear" dur="1000" repeat="indefinite"></a-animation>
                    </a-box>
                </a-marker>
                <a-marker kaohsung type="pattern" url="img/ar-markers/kaohsuang/pattern-marker-kaohsung.patt">
                    <a-gltf-model src="#clbf" position="0 0.5 0" rotation="0 180 0" scale="0.00001 0.00001 0.00001">
                            <a-animation  attribute="rotation" to="0 180 360"
                            easing="linear" dur="3000" repeat="indefinite"></a-animation>
                    </a-gltf-model>  
                    <!-- <a-box  position='0 0.5 0' material='color: white;'>
                        <a-animation  attribute="rotation" to="0 360 0"
                        easing="linear" dur="1000" repeat="indefinite"></a-animation>
                    </a-box> -->
                </a-marker>
                <a-marker taichung type="pattern" url="img/ar-markers/taichung/pattern-marker-taichung.patt">
                    <a-box  position='0 0.5 0' material='color: yellow;'>
                        <a-animation  attribute="rotation" to="0 360 0"
                        easing="linear" dur="1000" repeat="indefinite"></a-animation>
                    </a-box>
                </a-marker>
                <a-marker tainan type="pattern" url="img/ar-markers/tainan/pattern-marker-tainan.patt">
                    <a-box  position='0 0.5 0' material='color: black;'>
                        <a-animation  attribute="rotation" to="0 360 0"
                        easing="linear" dur="1000" repeat="indefinite"></a-animation>
                    </a-box>
                </a-marker>
                <a-marker taitong type="pattern" url="img/ar-markers/taitong/pattern-marker-taitong.patt">
                    <a-box  position='0 0.5 0' material='color: red;'>
                        <a-animation  attribute="rotation" to="0 360 0"
                        easing="linear" dur="1000" repeat="indefinite"></a-animation>
                    </a-box>
                </a-marker>
                 <!-- <a-marker-camera id="camera" preset='hiro' position="0 0 23"> </a-marker-camera>  -->
                <a-camera-static  position="0 0 13"/>
                <!-- <a-entity camera position="-2 13 0" rotation="-90 0 0"></a-entity> -->
        </a-scene>
        <div class="linkContent">
           
        </div>
        <!-- <div class="btnContent">
            <button id="change" onClick="changeModel()">Click me to change model</button>
        </div> -->
    <!-- <div id="sceneContainer"></div>
<script type="text/javascript" src="index_bundle.js"></script> -->
</body>
</html>